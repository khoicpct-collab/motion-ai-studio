<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Motion AI Studio - Hoàn chỉnh</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/x-icon" href="https://img.icons8.com/color/96/000000/particles.png">
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <header class="header">
            <div class="logo">
                <i class="fas fa-atom"></i>
                <h1>Motion AI Studio</h1>
                <span class="version">v2.0 HOÀN CHỈNH</span>
            </div>
            <div class="header-controls">
                <div class="fps-display">
                    <span id="fpsCounter">60 FPS</span>
                    <div class="fps-bar">
                        <div id="fpsBar" class="fps-fill"></div>
                    </div>
                </div>
                <button id="helpBtn" class="btn-help">
                    <i class="fas fa-question-circle"></i> Hướng dẫn
                </button>
            </div>
        </header>

        <!-- MAIN CONTENT -->
        <div class="main-content">
            <!-- LEFT SIDEBAR -->
            <div class="sidebar left-sidebar">
                <div class="section">
                    <h3><i class="fas fa-upload"></i> Tải lên</h3>
                    <div class="upload-group">
                        <label class="upload-btn">
                            <i class="fas fa-image"></i> Upload Background
                            <input type="file" id="uploadBackground" accept="image/*,video/*,.gif" hidden>
                        </label>
                        <label class="upload-btn">
                            <i class="fas fa-palette"></i> Upload Material
                            <input type="file" id="uploadMaterial" accept="image/*" hidden>
                        </label>
                        <button id="loadDemo" class="btn-secondary">
                            <i class="fas fa-rocket"></i> Load Demo
                        </button>
                    </div>
                </div>

                <div class="section">
                    <h3><i class="fas fa-pencil-alt"></i> Công cụ vẽ</h3>
                    <div class="tool-grid">
                        <button class="tool-btn active" data-tool="select">
                            <i class="fas fa-mouse-pointer"></i> Select
                        </button>
                        <button class="tool-btn" data-tool="pen">
                            <i class="fas fa-pen"></i> Pen
                        </button>
                        <button class="tool-btn" data-tool="rectangle">
                            <i class="fas fa-square"></i> Rectangle
                        </button>
                        <button class="tool-btn" data-tool="circle">
                            <i class="fas fa-circle"></i> Circle
                        </button>
                    </div>
                    <div class="ai-tools">
                        <button id="aiSmoothBtn" class="btn-ai">
                            <i class="fas fa-magic"></i> Smooth Path AI
                        </button>
                    </div>
                </div>

                <div class="section">
                    <h3><i class="fas fa-industry"></i> Thiết bị công nghiệp</h3>
                    <div class="device-grid">
                        <button class="device-preset" data-device="screw-conveyor">
                            <i class="fas fa-screwdriver"></i> Vít tải
                        </button>
                        <button class="device-preset" data-device="conveyor-belt">
                            <i class="fas fa-conveyor-belt"></i> Băng tải
                        </button>
                        <button class="device-preset" data-device="mixer">
                            <i class="fas fa-blender"></i> Máy trộn
                        </button>
                        <button class="device-preset" data-device="vibrating-screen">
                            <i class="fas fa-filter"></i> Sàng rung
                        </button>
                        <button class="device-preset" data-device="pump">
                            <i class="fas fa-tint"></i> Bơm
                        </button>
                    </div>
                </div>
            </div>

            <!-- CANVAS AREA -->
            <div class="canvas-container">
                <div class="canvas-header">
                    <h3><i class="fas fa-play-circle"></i> Animation Preview</h3>
                    <div class="animation-controls">
                        <button id="playBtn" class="btn-play">
                            <i class="fas fa-play"></i> Play
                        </button>
                        <button id="stopBtn" class="btn-stop">
                            <i class="fas fa-stop"></i> Stop
                        </button>
                    </div>
                </div>
                <canvas id="mainCanvas" width="1920" height="1080"></canvas>
                
                <!-- Direction Controls -->
                <div class="direction-grid">
                    <button class="dir-btn" data-dir="↖">↖</button>
                    <button class="dir-btn" data-dir="↑">↑</button>
                    <button class="dir-btn" data-dir="↗">↗</button>
                    <button class="dir-btn" data-dir="←">←</button>
                    <button class="dir-btn" data-dir="○">○</button>
                    <button class="dir-btn" data-dir="→">→</button>
                    <button class="dir-btn" data-dir="↙">↙</button>
                    <button class="dir-btn" data-dir="↓">↓</button>
                    <button class="dir-btn" data-dir="↘">↘</button>
                </div>
            </div>

            <!-- RIGHT SIDEBAR -->
            <div class="sidebar right-sidebar">
                <div class="section">
                    <h3><i class="fas fa-sliders-h"></i> Điều khiển chuyển động</h3>
                    
                    <div class="control-group">
                        <label>Motion Type</label>
                        <div class="motion-grid">
                            <button class="motion-option active" data-motion="flow">
                                <i class="fas fa-water"></i> Flow
                            </button>
                            <button class="motion-option" data-motion="follow">
                                <i class="fas fa-road"></i> Follow
                            </button>
                            <button class="motion-option" data-motion="swirl">
                                <i class="fas fa-sync-alt"></i> Swirl
                            </button>
                            <button class="motion-option" data-motion="random">
                                <i class="fas fa-random"></i> Random
                            </button>
                        </div>
                    </div>

                    <div class="control-group">
                        <label>Speed: <span id="speedValue">50%</span></label>
                        <input type="range" id="speedSlider" min="1" max="100" value="50" class="slider">
                    </div>

                    <div class="control-group">
                        <label>Particle Count: <span id="countValue">100</span></label>
                        <input type="range" id="countSlider" min="10" max="1000" value="100" class="slider">
                    </div>

                    <div class="control-group">
                        <label>Particle Size: <span id="sizeValue">10</span></label>
                        <input type="range" id="sizeSlider" min="2" max="50" value="10" class="slider">
                    </div>
                </div>

                <div class="section">
                    <h3><i class="fas fa-robot"></i> AI Features</h3>
                    <div class="ai-presets">
                        <button id="waterPreset" class="ai-preset-btn water">
                            <i class="fas fa-tint"></i> Water
                        </button>
                        <button id="smokePreset" class="ai-preset-btn smoke">
                            <i class="fas fa-smog"></i> Smoke
                        </button>
                        <button id="particlesPreset" class="ai-preset-btn particles">
                            <i class="fas fa-star"></i> Particles
                        </button>
                    </div>
                    <button id="aiOptimizeBtn" class="btn-ai-primary">
                        <i class="fas fa-bolt"></i> Optimize with AI
                    </button>
                </div>

                <div class="section">
                    <h3><i class="fas fa-download"></i> Export</h3>
                    <div class="export-grid">
                        <button id="exportGif" class="export-btn gif">
                            <i class="fas fa-film"></i> GIF
                        </button>
                        <button id="exportMp4" class="export-btn mp4">
                            <i class="fas fa-video"></i> MP4
                        </button>
                        <button id="exportPng" class="export-btn png">
                            <i class="fas fa-image"></i> PNG
                        </button>
                    </div>
                    
                    <div class="export-options">
                        <div class="option-group">
                            <label>Quality:</label>
                            <select id="qualitySelect" class="select-box">
                                <option value="low">Low</option>
                                <option value="medium" selected>Medium</option>
                                <option value="high">High</option>
                                <option value="ultra">Ultra</option>
                            </select>
                        </div>
                        
                        <div class="option-group">
                            <label>FPS:</label>
                            <select id="fpsSelect" class="select-box">
                                <option value="15">15</option>
                                <option value="24">24</option>
                                <option value="30" selected>30</option>
                                <option value="60">60</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- STATUS BAR -->
        <div class="status-bar">
            <div class="status-item">
                <i class="fas fa-cube"></i>
                <span>Particles: <strong id="particleCountDisplay">100</strong></span>
            </div>
            <div class="status-item">
                <i class="fas fa-bolt"></i>
                <span>Motion: <strong id="motionTypeDisplay">Flow</strong></span>
            </div>
            <div class="status-item">
                <i class="fas fa-draw-polygon"></i>
                <span>Paths: <strong id="pathCountDisplay">0</strong></span>
            </div>
            <div class="status-item">
                <i class="fas fa-hdd"></i>
                <span>Ready to export</span>
            </div>
        </div>
    </div>

    <!-- MODALS -->
    <div id="tutorialModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-graduation-cap"></i> Hướng dẫn sử dụng</h2>
                <button id="closeTutorial" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="tutorial-step">
                    <h3><i class="fas fa-upload"></i> Bước 1: Tải lên</h3>
                    <p>• Click "Upload Background" để tải hình nền GIF/Video/Image</p>
                    <p>• Click "Upload Material" để tải hình ảnh cho particles</p>
                    <p>• Hoặc click "Load Demo" để xem ví dụ có sẵn</p>
                </div>
                
                <div class="tutorial-step">
                    <h3><i class="fas fa-draw-polygon"></i> Bước 2: Vẽ đường dẫn</h3>
                    <p>• Chọn Pen tool để vẽ đường tự do</p>
                    <p>• Chọn Rectangle/Circle để vẽ hình dạng</p>
                    <p>• Click và kéo trên canvas để vẽ</p>
                </div>
                
                <div class="tutorial-step">
                    <h3><i class="fas fa-sliders-h"></i> Bước 3: Điều chỉnh</h3>
                    <p>• Chọn motion type: Flow, Follow, Swirl, Random</p>
                    <p>• Điều chỉnh speed, particle count, size</p>
                    <p>• Click các nút mũi tên để thay đổi hướng</p>
                </div>
                
                <div class="tutorial-step">
                    <h3><i class="fas fa-robot"></i> Bước 4: AI Features</h3>
                    <p>• Thử các AI presets: Water, Smoke, Particles</p>
                    <p>• Click "Optimize with AI" để tối ưu hóa tự động</p>
                    <p>• Click "Smooth Path AI" để làm mượt đường vẽ</p>
                </div>
                
                <div class="tutorial-step">
                    <h3><i class="fas fa-download"></i> Bước 5: Xuất file</h3>
                    <p>• Chọn định dạng: GIF, MP4, PNG</p>
                    <p>• Chọn chất lượng và FPS</p>
                    <p>• Click export và chờ quá trình hoàn tất</p>
                </div>
            </div>
        </div>
    </div>

    <div id="exportModal" class="modal hidden">
        <div class="modal-content export-modal">
            <div class="modal-header">
                <h2><i class="fas fa-download"></i> Exporting Animation</h2>
            </div>
            <div class="modal-body">
                <div class="progress-container">
                    <div class="progress-bar">
                        <div id="exportProgress" class="progress-fill"></div>
                    </div>
                    <div id="exportProgressText" class="progress-text">Preparing export...</div>
                </div>
                
                <div class="export-steps">
                    <div class="step active">
                        <i class="fas fa-cog"></i>
                        <span>Processing</span>
                    </div>
                    <div class="step">
                        <i class="fas fa-film"></i>
                        <span>Rendering</span>
                    </div>
                    <div class="step">
                        <i class="fas fa-sync-alt"></i>
                        <span>Encoding</span>
                    </div>
                    <div class="step">
                        <i class="fas fa-check-circle"></i>
                        <span>Complete</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NOTIFICATION CONTAINER -->
    <div id="notificationContainer" class="notification-container"></div>

    <script src="app.js"></script>
</body>
</html>
